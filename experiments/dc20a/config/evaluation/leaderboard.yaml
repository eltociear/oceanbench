build_eval_ds:
  _target_: experiments.dc20a.evaluation.merge_ds
  study_ds: ${results.data}
  ref_ds: ${reference.data}
  var: ssh
  _partial_: true

add_units:
  _target_: experiments.dc20a.evaluation.add_units
  _partial_: true
  units:
      ref: meter
      study: meter
      lon: degrees_east
      lat: degrees_north
      time: seconds

preprocessing:
  _target_: oceanbench._src.data.pipe
  _partial_: true
  fns:
    - ${evaluation.add_units}
    - ${evaluation.fill_nans}
    - ${evaluation.rescale_space}
    - ${evaluation.rescale_time}

metrics:
  nrmse_scalar: ${evaluation.nrmse_spacetime}
  nrmse_time: ${evaluation.nrmse_space}
  isotrop_psd_score: ${evaluation.psd_isotropic_score}
  spacetime_psd_scores: ${evaluation.psd_spacetime_score}

plots: {}
metrics_plots: {}

summary:
  experiment: ${results.experiment}
  method: ${results.name}
  datachallenge: DC20a_osse
  nrsme: 
    _target_: oceanbench._src.data.pipe
    _partial_: true
    fns:
      - {_target_: operator.itemgetter, _args_: [nrmse_scalar]}
      - {_target_: builtins.float, _partial_: true}
      - {_target_: builtins.str.format, _args_: ['{:.3f}'], _partial_: true}
  lambda_x_isotrop: 
    _target_: oceanbench._src.data.pipe
    _partial_: true
    fns:
      - {_target_: operator.itemgetter, _args_: [isotrop_psd_score]}
      - {_target_: operator.itemgetter, _args_: [1]}
      - {_target_: operator.mul, _args_: [1e-3], _partial_: true}
      - {_target_: builtins.str.format, _args_: ['{:.2f} km'], _partial_: true}
  lambda_x_spacetime: 
    _target_: oceanbench._src.data.pipe
    _partial_: true
    fns:
      - {_target_: operator.itemgetter, _args_: [spacetime_psd_scores]}
      - {_target_: operator.itemgetter, _args_: [1]}
      - {_target_: operator.mul, _args_: [1e-3], _partial_: true}
      - {_target_: builtins.str.format, _args_: ['{:.2f} km'], _partial_: true}
  lambda_t_spacetime: 
    _target_: oceanbench._src.data.pipe
    _partial_: true
    fns:
      - {_target_: operator.itemgetter, _args_: [spacetime_psd_scores]}
      - {_target_: operator.itemgetter, _args_: [2]}
      - {_target_: builtins.str.format, _args_: ['{:.2f} days'], _partial_: true}
defaults:
 - /evaluation/metrics@_group_
 - _self_
