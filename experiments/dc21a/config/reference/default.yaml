name: "nadir"
data:
  _target_: "xarray.open_mfdataset"
  paths:
    - ${data.c2}
  combine: "nested"
  concat_dim: "time"
  decode_times: True
  engine: "netcdf4"
  preprocess:
    _target_: "oceanbench._src.data.pipe"
    _partial_: True
    fns:
      # # RENAME
      - {_target_: "xarray.Dataset.rename", name_dict: {"longitude": "lon"}, _partial_: True}
      - {_target_: "xarray.Dataset.rename", name_dict: {"latitude": "lat"}, _partial_: True}
      # VALIDATE COORDINATES
      - {_target_: "oceanbench._src.geoprocessing.validation.validate_latlon", _partial_: True}
      - {_target_: "oceanbench._src.geoprocessing.validation.validate_time", _partial_: True}
      # - "${preprocess.decode_cf_time}"
      # SELECT REGION | TIME
      - "${preprocess.select_time}"
      - {_target_: "xarray.Dataset.compute", _partial_: True}
      - "${preprocess.select_lon_where}"
      - "${preprocess.select_lat_where}"
      - {_target_: "xarray.Dataset.sortby", variables: "time", _partial_: True}
      - {_target_: "xarray.Dataset.compute", _partial_: True}
      - {_target_: "oceanbench._src.preprocessing.alongtrack.alongtrack_ssh", _partial_: True}

